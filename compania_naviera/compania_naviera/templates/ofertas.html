{% extends "base.html" %}
{% load static %}

{% block title %}Ofertas de Cruceros - SEA STAR{% endblock %}

{% block content %}

<!-- ======= HERO ======= -->
<section class="mx-auto max-w-7xl px-6 lg:px-10 pt-8">
  <div class="rounded-3xl bg-gradient-to-br from-gray-800/80 via-gray-900/80 to-gray-800/95 border border-gray-700/40 p-8 md:p-10 backdrop-blur-xl shadow-neon text-gray-100">
    <div class="space-y-3">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-gray-700/40 border border-gray-600/50 text-xs tracking-wider">
        <span class="inline-flex w-5 h-5 items-center justify-center rounded-full bg-indigo-600 text-white font-bold">â˜…</span>
        Sea Star Â· Ofertas
      </div>
      <h1 class="text-3xl md:text-4xl font-extrabold">ðŸŒŠ Ofertas</h1>
      <p class="text-gray-300 max-w-3xl">
        Â¡DescubrÃ­ escapadas marÃ­timas con precios inigualables! Lujo, confort y paisajes de ensueÃ±o.
        ReservÃ¡ hoy mismo tu crucero ideal.
      </p>
    </div>
  </div>
</section>

<!-- ======= FILTROS DINÃMICOS ======= -->
<section class="max-w-7xl mx-auto px-6 lg:px-10 py-8">
  <div class="rounded-2xl border border-gray-700/40 bg-gray-800/80 backdrop-blur-xl p-6 md:p-8 shadow-lg">
    <h2 class="text-xl font-semibold text-gray-100 mb-4 flex items-center gap-2">
      <i class="fa-solid fa-filter text-indigo-600"></i> Filtrar ofertas
    </h2>

    <form method="get" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
      <!-- Destino -->
      <div class="flex flex-col">
        <label for="destino" class="text-sm font-medium text-gray-300/80 mb-1">Destino</label>
        <input type="text" name="destino" id="destino"
               value="{{ request.GET.destino|default:'' }}"
               placeholder="Ej: Caribe"
               class="w-full px-3 py-2 rounded-lg bg-gray-700/70 border border-gray-600/50 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
      </div>

      <!-- Fecha -->
      <div class="flex flex-col">
        <label for="fecha" class="text-sm font-medium text-gray-300/80 mb-1">Fecha de salida</label>
        <input type="date" name="fecha" id="fecha"
               value="{{ request.GET.fecha|default:'' }}"
               class="w-full px-3 py-2 rounded-lg bg-gray-700/70 border border-gray-600/50 text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
      </div>

      <!-- Precio mÃ­nimo -->
      <div class="flex flex-col">
        <label for="precio_min" class="text-sm font-medium text-gray-300/80 mb-1">Precio mÃ­nimo</label>
        <input type="number" name="precio_min" id="precio_min"
               value="{{ request.GET.precio_min|default:'' }}"
               placeholder="USD"
               min="0"
               class="w-full px-3 py-2 rounded-lg bg-gray-700/70 border border-gray-600/50 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
      </div>

      <!-- Precio mÃ¡ximo -->
      <div class="flex flex-col">
        <label for="precio_max" class="text-sm font-medium text-gray-300/80 mb-1">Precio mÃ¡ximo</label>
        <input type="number" name="precio_max" id="precio_max"
               value="{{ request.GET.precio_max|default:'' }}"
               placeholder="USD"
               min="0"
               class="w-full px-3 py-2 rounded-lg bg-gray-700/70 border border-gray-600/50 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
      </div>

      <!-- BotÃ³n -->
      <div class="flex flex-col justify-end">
        <button type="submit"
                class="w-full py-2.5 rounded-lg bg-indigo-600 text-white font-medium shadow-md hover:shadow-lg hover:scale-[1.02] transition">
          <i class="fa-solid fa-magnifying-glass"></i> Filtrar
        </button>
      </div>
    </form>
  </div>
</section>

<!-- ======= GRID DE OFERTAS ======= -->
<section class="max-w-7xl mx-auto px-6 lg:px-10 py-8">
  <div id="oCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 text-gray-100">

    {% if sin_resultados %}
      <div class="col-span-3 text-center py-10">
        <p class="text-gray-300 text-lg font-medium mb-2">
          No encontramos un viaje con esas especificaciones ðŸ˜•
        </p>
        <p class="text-gray-400 text-sm mb-6">
          Pero mirÃ¡ estas otras ofertas que podrÃ­an interesarte:
        </p>
      </div>

      {% for oferta in recomendadas %}
        <a href="{% url 'detalle_oferta' oferta.id %}"
           class="group relative block rounded-2xl p-[1px] bg-gradient-to-br from-gray-700/40 via-gray-800/10 to-transparent shadow-neon hover:shadow-2xl transition transform hover:-translate-y-1 duration-300">

          <div class="flex h-full flex-col rounded-2xl card-surface border border-gray-600/20 backdrop-blur-sm shadow-lg overflow-hidden bg-gray-800">
            <div class="relative">
              {% if oferta.navio.imagen %}
                <img src="{{ oferta.navio.imagen }}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% else %}
                <img src="{% static 'placeholder.jpg' %}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-t from-gray-900/85 via-transparent to-transparent"></div>

              <span class="absolute top-3 left-3 text-xs px-2 py-1 rounded-full bg-gray-700/60 text-gray-300">{{ oferta.categoria_nombre }}</span>
              <span class="absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-indigo-600 text-white font-bold shadow-[0_10px_22px_rgba(0,0,0,0.3)]">
                USD {{ oferta.precio }}
              </span>
            </div>

            <div class="p-6 flex flex-col gap-3">
              <h3 class="text-xl font-semibold flex items-center gap-2">
                <i class="fa-solid fa-ship text-indigo-500"></i> {{ oferta.viaje.nombre }}
              </h3>
              <p class="text-gray-300 text-sm">
                {{ oferta.noches }} noches hacia {{ oferta.viaje.lugar_destino }}.
                {{ oferta.viaje.descripcion|default:"DisfrutÃ¡ de este viaje Ãºnico." }}
              </p>

              <div class="mt-auto flex items-center justify-between gap-3 pt-2 text-xs text-gray-400">
                <span class="inline-flex items-center gap-1"><i class="fa-regular fa-moon"></i> {{ oferta.noches }} noches</span>
                <span class="opacity-50">â€¢</span>
                <span class="inline-flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> {{ oferta.viaje.lugar_destino }}</span>
              </div>
            </div>
          </div>
        </a>
      {% endfor %}

    {% elif ofertas %}
      {% for oferta in ofertas %}
        <!-- ðŸ” Tu card normal de oferta -->
        <a href="{% url 'detalle_oferta' oferta.id %}" 
           class="group relative block rounded-2xl p-[1px] bg-gradient-to-br from-gray-700/40 via-gray-800/10 to-transparent shadow-neon hover:shadow-2xl transition transform hover:-translate-y-1 duration-300">
          <div class="flex h-full flex-col rounded-2xl card-surface border border-gray-600/20 backdrop-blur-sm shadow-lg overflow-hidden bg-gray-800">
            <div class="relative">
              {% if oferta.navio.imagen %}
                <img src="{{ oferta.navio.imagen }}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% else %}
                <img src="{% static 'placeholder.jpg' %}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-t from-gray-900/85 via-transparent to-transparent"></div>
              <span class="absolute top-3 left-3 text-xs px-2 py-1 rounded-full bg-gray-700/60 text-gray-300">{{ oferta.categoria_nombre }}</span>
              <span class="absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-indigo-600 text-white font-bold shadow-[0_10px_22px_rgba(0,0,0,0.3)]">USD {{ oferta.precio }}</span>
            </div>
            <div class="p-6 flex flex-col gap-3">
              <h3 class="text-xl font-semibold flex items-center gap-2">
                <i class="fa-solid fa-ship text-indigo-500"></i> {{ oferta.viaje.nombre }}
              </h3>
              <p class="text-gray-300 text-sm">
                {{ oferta.noches }} noches hacia {{ oferta.viaje.lugar_destino }}.
                {{ oferta.viaje.descripcion|default:"DisfrutÃ¡ de este viaje Ãºnico." }}
              </p>
              <div class="mt-auto flex items-center justify-between gap-3 pt-2 text-xs text-gray-400">
                <span class="inline-flex items-center gap-1"><i class="fa-regular fa-moon"></i> {{ oferta.noches }} noches</span>
                <span class="opacity-50">â€¢</span>
                <span class="inline-flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> {{ oferta.viaje.lugar_destino }}</span>
              </div>
            </div>
          </div>
        </a>
      {% endfor %}
    {% else %}
      <p class="col-span-3 text-center text-gray-400">No hay ofertas disponibles en este momento.</p>
    {% endif %}

  </div>
</section>

{% endblock %}

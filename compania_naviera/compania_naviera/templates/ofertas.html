{% extends "base.html" %}
{% load static %}

{% block title %}Ofertas de Cruceros - SEA STAR{% endblock %}

{% block content %}

<!-- ======= HERO ======= -->
<section class="mx-auto max-w-7xl px-6 lg:px-10 pt-8">
  <div class="ofertas-hero rounded-3xl border border-primary/35 p-8 md:p-10 shadow-neon text-text">
    <div class="flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
      <div class="space-y-4 max-w-2xl">
        <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/12 border border-primary/35 text-xs sm:text-sm font-semibold tracking-[0.18em] uppercase text-primary-dark">
          <i class="fa-solid fa-star text-secondary"></i> Sea Star ¬∑ Ofertas
        </span>
        <div class="flex items-start gap-3">
          <span class="ofertas-hero__icon">
            <i class="fa-solid fa-water"></i>
          </span>
          <div class="space-y-3">
            <h1 class="text-3xl md:text-4xl font-black text-primary-dark">Ofertas imperdibles</h1>
            <p class="text-text/80 leading-relaxed">
              Descubr√≠ escapadas mar√≠timas con precios inigualables: lujo, confort y paisajes de ensue√±o
              en un solo lugar. Reserv√° hoy y asegur√° tu cabina ideal para el pr√≥ximo viaje.
            </p>
          </div>
        </div>
      </div>
      <div class="ofertas-hero__card">
        <span class="text-xs uppercase tracking-wide text-text/60">Tip de la tripulaci√≥n</span>
        <p class="text-sm text-text/80 mt-1">
          Consult√° reservas flexibles para congelar precios y obten√© upgrades gratuitos en temporada media.
        </p>
      </div>
    </div>
  </div>
</section>

<!-- ======= FILTROS ======= -->
<section class="max-w-7xl mx-auto px-6 lg:px-10 py-8">
  <div class="card-soft rounded-2xl border border-primary/35 p-6 md:p-8 shadow-lg">
    <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-6">
      <h2 class="text-xl font-semibold text-primary-dark flex items-center gap-2">
        <span class="inline-flex h-9 w-9 items-center justify-center rounded-full bg-secondary/15 text-secondary">
          <i class="fa-solid fa-filter"></i>
        </span>
        Filtrar ofertas
      </h2>
      {% if request.GET %}
        <a href="{% url 'ofertas' %}" class="text-sm font-semibold link-secondary">Limpiar filtros</a>
      {% endif %}
    </div>

    <form method="get" class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5">
      <div class="flex flex-col gap-2">
        <label for="destino" class="text-xs font-medium uppercase tracking-wide text-text/60">Destino</label>
        <div class="offer-filter-field">
          <span class="offer-filter-field__icon"><i class="fa-solid fa-location-dot"></i></span>
          <input type="text" name="destino" id="destino"
                 value="{{ request.GET.destino|default:'' }}"
                 placeholder="Ej: Caribe"
                 class="offer-filter-field__input">
        </div>
      </div>

      <div class="flex flex-col gap-2">
        <label for="fecha" class="text-xs font-medium uppercase tracking-wide text-text/60">Fecha de salida</label>
        <div class="offer-filter-field">
          <span class="offer-filter-field__icon"><i class="fa-solid fa-calendar-days"></i></span>
          <input type="date" name="fecha" id="fecha"
                 value="{{ request.GET.fecha|default:'' }}"
                 class="offer-filter-field__input offer-filter-field__input--date">
        </div>
      </div>

      <div class="flex flex-col gap-2">
        <label for="precio_min" class="text-xs font-medium uppercase tracking-wide text-text/60">Precio m√≠nimo</label>
        <div class="offer-filter-field">
          <span class="offer-filter-field__icon"><i class="fa-solid fa-dollar-sign"></i></span>
          <input type="number" name="precio_min" id="precio_min"
                 value="{{ request.GET.precio_min|default:'' }}"
                 placeholder="USD"
                 min="0"
                 class="offer-filter-field__input">
        </div>
      </div>

      <div class="flex flex-col gap-2">
        <label for="precio_max" class="text-xs font-medium uppercase tracking-wide text-text/60">Precio m√°ximo</label>
        <div class="offer-filter-field">
          <span class="offer-filter-field__icon"><i class="fa-solid fa-arrow-trend-up"></i></span>
          <input type="number" name="precio_max" id="precio_max"
                 value="{{ request.GET.precio_max|default:'' }}"
                 placeholder="USD"
                 min="0"
                 class="offer-filter-field__input">
        </div>
      </div>

      <div class="flex flex-col justify-end">
        <button type="submit"
                class="offer-filter__button">
          <i class="fa-solid fa-magnifying-glass"></i>
          Filtrar
        </button>
      </div>
    </form>
  </div>
</section>

<!-- ======= GRID DE OFERTAS ======= -->
<section class="max-w-7xl mx-auto px-6 lg:px-10 pb-10">
  <div id="oCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 text-text">

    {% if sin_resultados %}
      <div class="col-span-full text-center py-9 card-soft border border-primary/35 rounded-3xl">
        <p class="text-lg font-semibold text-primary mb-2">
          No encontramos un viaje con esas especificaciones üòï
        </p>
        <p class="text-sm text-text/70 mb-6">
          Revis√° estas propuestas recomendadas, tal vez encajen con lo que ten√≠as en mente.
        </p>
      </div>

      {% for oferta in recomendadas %}
        <a href="{% url 'detalle_oferta' oferta.id %}"
           class="group relative block rounded-2xl p-[1px] bg-gradient-to-br from-primary/25 via-accent/15 to-transparent shadow-neon hover:shadow-xl transition transform hover:-translate-y-1 duration-300">
          <div class="oferta-card flex h-full flex-col rounded-2xl card-surface border border-primary/25 overflow-hidden">
            <div class="relative">
              {% if oferta.navio.imagen %}
                <img src="{{ oferta.navio.imagen }}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% else %}
                <img src="{% static 'placeholder.jpg' %}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-t from-primary/55 via-transparent to-transparent"></div>

              <span class="badge badge--light absolute top-3 left-3">{{ oferta.categoria_nombre }}</span>
              <span class="badge badge--primary absolute top-3 right-3">USD {{ oferta.precio }}</span>
              {% if oferta.cabin_image %}
                <div class="absolute bottom-3 right-3 flex items-end gap-3">
                  <div class="rounded-2xl border border-white/60 bg-white/85 px-3 py-2 text-[10px] font-semibold uppercase tracking-[0.3em] text-text/70 shadow-lg">
                    Cabina real
                    <p class="mt-1 text-[11px] tracking-normal text-text font-normal">{{ oferta.cabin_label }}</p>
                  </div>
                  <div class="h-16 w-24 overflow-hidden rounded-2xl border border-white/70 shadow-xl">
                    <img src="{{ oferta.cabin_image }}" alt="Camarote destacado de {{ oferta.navio.nombre }}" class="h-full w-full object-cover" loading="lazy">
                  </div>
                </div>
              {% endif %}
            </div>

            <div class="p-6 flex flex-col gap-3">
              <h3 class="text-xl font-semibold flex items-center gap-2 text-primary-dark">
                <i class="fa-solid fa-ship text-secondary"></i> {{ oferta.viaje.nombre }}
              </h3>
              <p class="text-text/75 text-sm leading-relaxed">
                {{ oferta.noches }} noches hacia {{ oferta.viaje.lugar_destino }}.
                {{ oferta.viaje.descripcion|default:"Disfrut√° de este viaje √∫nico." }}
              </p>

              <div class="mt-auto flex items-center justify-between gap-3 pt-2 text-xs text-text/60">
                <span class="inline-flex items-center gap-1"><i class="fa-regular fa-moon"></i> {{ oferta.noches }} noches</span>
                <span class="opacity-40">‚Ä¢</span>
                <span class="inline-flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> {{ oferta.viaje.lugar_destino }}</span>
              </div>
            </div>
          </div>
        </a>
      {% endfor %}

    {% elif ofertas %}
      {% for oferta in ofertas %}
        <a href="{% url 'detalle_oferta' oferta.id %}" 
           class="group relative block rounded-2xl p-[1px] bg-gradient-to-br from-primary/25 via-accent/15 to-transparent shadow-neon hover:shadow-xl transition transform hover:-translate-y-1 duration-300">
          <div class="oferta-card flex h-full flex-col rounded-2xl card-surface border border-primary/25 overflow-hidden">
            <div class="relative">
              {% if oferta.navio.imagen %}
                <img src="{{ oferta.navio.imagen }}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% else %}
                <img src="{% static 'placeholder.jpg' %}" alt="{{ oferta.navio.nombre }}" class="w-full h-56 object-cover transition duration-500 group-hover:scale-105">
              {% endif %}
              <div class="absolute inset-0 bg-gradient-to-t from-primary/55 via-transparent to-transparent"></div>

              <span class="badge badge--light absolute top-3 left-3">{{ oferta.categoria_nombre }}</span>
              <span class="badge badge--primary absolute top-3 right-3">USD {{ oferta.precio }}</span>
              {% if oferta.cabin_image %}
                <div class="absolute bottom-3 right-3 flex items-end gap-3">
                  <div class="rounded-2xl border border-white/60 bg-white/85 px-3 py-2 text-[10px] font-semibold uppercase tracking-[0.3em] text-text/70 shadow-lg">
                    Cabina real
                    <p class="mt-1 text-[11px] tracking-normal text-text font-normal">{{ oferta.cabin_label }}</p>
                  </div>
                  <div class="h-16 w-24 overflow-hidden rounded-2xl border border-white/70 shadow-xl">
                    <img src="{{ oferta.cabin_image }}" alt="Camarote destacado de {{ oferta.navio.nombre }}" class="h-full w-full object-cover" loading="lazy">
                  </div>
                </div>
              {% endif %}
            </div>

            <div class="p-6 flex flex-col gap-3">
              <h3 class="text-xl font-semibold flex items-center gap-2 text-primary-dark">
                <i class="fa-solid fa-ship text-secondary"></i> {{ oferta.viaje.nombre }}
              </h3>
              <p class="text-text/75 text-sm leading-relaxed">
                {{ oferta.noches }} noches hacia {{ oferta.viaje.lugar_destino }}.
                {{ oferta.viaje.descripcion|default:"Disfrut√° de este viaje √∫nico." }}
              </p>

              <div class="mt-auto flex items-center justify-between gap-3 pt-2 text-xs text-text/60">
                <span class="inline-flex items-center gap-1"><i class="fa-regular fa-moon"></i> {{ oferta.noches }} noches</span>
                <span class="opacity-40">‚Ä¢</span>
                <span class="inline-flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> {{ oferta.viaje.lugar_destino }}</span>
              </div>
            </div>
          </div>
        </a>
      {% endfor %}
    {% else %}
      <p class="col-span-full text-center text-text/60">No hay ofertas disponibles en este momento.</p>
    {% endif %}

  </div>
</section>

<style>
  .ofertas-hero {
    background: linear-gradient(145deg, rgba(243, 245, 255, 0.98), rgba(227, 233, 255, 0.9));
  }
  .ofertas-hero__icon {
    width: 3.25rem;
    height: 3.25rem;
    border-radius: 1.2rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, rgba(31, 58, 147, 0.95), rgba(122, 62, 242, 0.9));
    color: #FFFFFF;
    font-size: 1.5rem;
    box-shadow: 0 16px 34px rgba(15, 30, 99, 0.24);
  }
  .ofertas-hero__card {
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(31, 58, 147, 0.12);
    border-radius: 1.5rem;
    padding: 1.5rem;
    max-width: 18rem;
    box-shadow: 0 18px 34px rgba(15, 30, 99, 0.16);
  }
  .badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 9999px;
    padding: 0.35rem 0.75rem;
    font-size: 0.75rem;
    font-weight: 600;
  }
  .badge--primary {
    background: linear-gradient(135deg, rgba(122, 62, 242, 0.95), rgba(31, 58, 147, 0.9));
    color: #FFFFFF;
    box-shadow: 0 12px 24px rgba(15, 30, 99, 0.25);
  }
  .badge--light {
    background: rgba(243, 245, 255, 0.92);
    color: rgba(11, 19, 48, 0.75);
    border: 1px solid rgba(31, 58, 147, 0.18);
  }
  .oferta-card {
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.96), rgba(243, 245, 255, 0.94));
  }
  .offer-filter-field {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    background: rgba(255, 255, 255, 0.96);
    border: 1px solid rgba(31, 58, 147, 0.18);
    box-shadow: 0 10px 22px rgba(15, 30, 99, 0.08);
    transition: border-color 200ms ease, box-shadow 200ms ease, transform 200ms ease;
  }
  .offer-filter-field:hover,
  .offer-filter-field:focus-within {
    border-color: rgba(31, 58, 147, 0.55);
    box-shadow: 0 18px 30px rgba(15, 30, 99, 0.14);
    transform: translateY(-2px);
  }
  .offer-filter-field__icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.2rem;
    height: 2.2rem;
    border-radius: 0.85rem;
    background: rgba(122, 62, 242, 0.15);
    color: var(--secondary-dark);
    font-size: 1rem;
    flex-shrink: 0;
  }
  .offer-filter-field__input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text);
    font-size: 0.95rem;
  }
  .offer-filter-field__input::placeholder {
    color: rgba(11, 19, 48, 0.5);
  }
  .offer-filter-field__input:focus {
    outline: none;
  }
  .offer-filter-field__input--date {
    color-scheme: light;
  }
  .offer-filter__button {
    width: 100%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.85rem 1rem;
    border-radius: 1rem;
    font-weight: 600;
    color: #FFFFFF;
    background: linear-gradient(135deg, rgba(31, 58, 147, 0.95), rgba(122, 62, 242, 0.9));
    box-shadow: 0 18px 34px rgba(31, 58, 147, 0.22);
    transition: transform 200ms ease, box-shadow 200ms ease;
    border: none;
    outline: none;
  }
  .offer-filter__button:hover,
  .offer-filter__button:focus-visible {
    transform: translateY(-2px);
    box-shadow: 0 22px 38px rgba(31, 58, 147, 0.28);
  }
</style>

{% endblock %}
